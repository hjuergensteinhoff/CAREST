# CAREST
## CAREST: Controlling and Recording Experiments in Sensitivity to Temperature

**For details and citation, please see: H.J. Steinhoff and A. Steinhoff, CAREST: A Tool for Temperature Sensitivity Experiments with Adolescents Including Real-Time Recordings of Temperature, Contact Force, and Self-Ratings**


**CAREST** is a PsychoPy-based tool for a reaction-time independent assessment of temperature and pain sensitivity via thermal induction. CAREST controls and communicates with a cold/hot plate (AHP 1200. Thermoelectric Cooling America Corporation, Chicago, USA) and provides a touchscreen slider to assess pain sensation on a Visual Analogue Scale (VAS). The plate is placed on a platform with load cells (M5Stack Technology Co., Ltd., China) measure hand-plate contact force, providing an objective assessment of thermal contact between hand and plate surface during the experiment. CAREST continuously records timestamped values of plate surface temperature, participants’ VAS rating and hand-plate contact force facilitating measures of temperature and pain sensitivity within a single experimental setting. 
The software package consists of CAREST.psyexp, HP_commands.py, config.dat, VAS.jpg, scale.ino and Plot_CAREST.py. The first four files have to be in the same folder. CAREST was developed using PsychoPy v2024.1.4., scale.ino was compiled with Arduino IDE 2.3.3.

## Hardware:

The experimental setup consists of an AHP-1200 dual cold/heat plate (Thermoelectric Cooling America Corporation, Chicago, USA) placed on a scale platform with four load cells (M5Stack Technology Co., Ltd., China). The analogue signals from the load cells are digitized by an HX711 24-bit A/D converter chip (M5Stack) and transmitted to a touchscreen laptop (Windows 11) via an ESP32 Basic Core IoT Development Kit V2.7 (M5Stack). The internal temperature controller (ATEC302) of the AHP-1200 cold/heat plate is connected to the second USB port of the laptop. Upon installation of the hardware the load cells should be calibrated with known weights ranging between 10 and 50 N.

## Software:

The ESP32-based scale interface runs the program 'scale.ino'. This program reads the signals from the four load cells via an HX711 A/D converter at a rate of ten samples per second. After applying the calibration factor, the calculated force values are stored, displayed on the M5Stack LCD, and transmitted on request from CAREST via the serial connection. Additionally, a color-coded background on the display visually indicates whether the measured force is below (red) or above (green) a defined threshold. The scale can be forced to tare by sending “0” to its serial port. Serial communication between scale.ino and CAREST is prompted by a blinking dot on the lower left corner of the LCD display. 
CAREST.psyexp was developed using the Psychopy software package (Peirce et al., 2019) using Code components for interaction with the plate and scale. The “library” “HP_commands_config.py” codes for the commands controlling and communicating with the ATEC302 temperature controller (commands were coded according to commands byte tables published in the ATEC302 TE Temperature Controller Reference Manual Rev 1.10, Mar, 2018, received from Thermoelectric Cooling America Corporation). In addition, it enables reading the user editable input file “config.dat” which contains the temperature and timing values for the cold or heat pain experiments. For safety reasons baseline temperatures are limited to values in the range between 10 °C and 45 °C, peak temperatures are limited to values between 5 °C and 49 °C. The ramp up time to the peak temperature is limited to rates less than 1 °C /13 s, and the plate is actively cooled upon reaching the peak temperature (hold_time_pt = 0) to avoid non-acceptable overshooting of the target temperature without changing the default settings of the ATEC PID controller. In the beginning of each experiment the temperature and timing values are uploaded to the ATEC temperature controller and the plate is controlled to the baseline temperature. After the adaptation phase the temperature ramp is started. VAS pain ratings, hand-plate contact force and actual plate temperatures are recorded every two seconds during the adaptation and ramping phases.

Relevant data are saved in a .csv output file. The name of the output file contains the participant and session numbers. Absolute times are included for all rows (i.e., in two-seconds-intervals), which facilitates subsequent linking of temperatures, hand-plate contact force, and VAS ratings with other assessment derived measures using external devices, such as time-stamped ECG.  The add-on program, plot_CAREST, where output files can be inserted via a drag-and-drop feature, plots contact force and VAS pain ratings vs temperature as well as ratings for the hypothetical vignettes, thus facilitating a quick check of data recorded during an individual experiment. 


 
